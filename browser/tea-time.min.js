(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.createTeaTime=e()}})(function(){var e,t,r;return function i(e,t,r){function n(a,o){if(!t[a]){if(!e[a]){var l=typeof require=="function"&&require;if(!o&&l)return l(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=t[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return n(r?r:t)},c,c.exports,i,e,t,r)}return t[a].exports}var s=typeof require=="function"&&require;for(var a=0;a<r.length;a++)n(r[a]);return n}({1:[function(e,t,r){"use strict";var i=e("./tea-time.js");function n(){var e={microTimeout:function(e){setTimeout(e,0)},onceUncaughtException:function(e){var t=false;window.onerror=function(r,i,n,s,a){if(t){return}e(a);return true}},offUncaughtException:function(){window.onerror=function(){}},allowConsole:true};window.teaTime=i.create(e);window.teaTime.init();return window.teaTime}t.exports=n},{"./tea-time.js":2}],2:[function(e,t,r){(function(r){"use strict";var i=e("async-kit");var n=e("nextgen-events");function s(){throw new Error("Use TeaTime.create() instead")}s.prototype=Object.create(n.prototype);s.prototype.constructor=s;t.exports=s;s.create=function a(e){var t=Object.create(s.prototype,{timeout:{value:e.timeout||2e3,writable:true,enumerable:true},slowTime:{value:e.slowTime||75,writable:true,enumerable:true},suite:{value:s.createSuite(),enumerable:true},grep:{value:Array.isArray(e.grep)?e.grep:[],writable:true,enumerable:true},allowConsole:{value:!!e.allowConsole,writable:true,enumerable:true},bail:{value:!!e.bail,writable:true,enumerable:true},startTime:{value:0,writable:true,enumerable:true},testCount:{value:0,writable:true,enumerable:true},done:{value:0,writable:true,enumerable:true},ok:{value:0,writable:true,enumerable:true},fail:{value:0,writable:true,enumerable:true},skip:{value:0,writable:true,enumerable:true},errors:{value:[],enumerable:true},microTimeout:{value:e.microTimeout,enumerable:true},onceUncaughtException:{value:e.onceUncaughtException,enumerable:true},offUncaughtException:{value:e.offUncaughtException,enumerable:true}});Object.defineProperties(t,{registerStack:{value:[t.suite],writable:true,enumerable:true}});return t};s.prototype.init=function o(e){r.suite=r.describe=r.context=s.registerSuite.bind(this);r.test=r.it=r.specify=s.registerTest.bind(this);r.test.skip=s.registerSkipTest.bind(this);r.setup=r.beforeEach=s.registerHook.bind(this,"setup");r.teardown=r.afterEach=s.registerHook.bind(this,"teardown");r.suiteSetup=r.before=s.registerHook.bind(this,"suiteSetup");r.suiteTeardown=r.after=s.registerHook.bind(this,"suiteTeardown");if(!this.allowConsole){s.disableConsole()}};s.disableConsole=function l(){console.log=console.error=console.assert=console.info=console.dir=console.warn=console.trace=console.time=console.timeEnd=function(){}};s.createSuite=function u(e){var t=[];Object.defineProperties(t,{name:{value:e},parent:{value:null,writable:true},suiteSetup:{value:[]},suiteTeardown:{value:[]},setup:{value:[]},teardown:{value:[]}});return t};s.sortSuite=function c(e){e.sort(function(e,t){var r=Array.isArray(e)?1:0;var i=Array.isArray(t)?1:0;if(r-i){return r-i}return e.order-t.order})};s.prototype.run=function f(e){var t=this,r=false;s.sortSuite(this.suite);this.emit("run");var i=function(){if(r){return}if(typeof e==="function"){e()}};this.startTime=Date.now();this.runSuite(t.suite,0,function(){t.emit("report",t.ok,t.fail,t.skip,Date.now()-t.startTime);if(t.fail){t.emit("errorReport",t.errors)}t.emit("exit",i);setTimeout(i,1e4)})};s.prototype.runSuite=function p(e,t,r){var i=this;if(t){i.emit("enterSuite",e.name,t-1)}var n=function(n){if(t){i.emit("exitSuite",e.name,t-1)}r(n)};this.runHooks(e.suiteSetup,t,function(r){if(r){i.patchError(r);i.errors.push({name:r.hookFn.hookName+"["+r.hookFn.hookType+"]",type:r.hookFn.hookType,fn:r.hookFn,error:r});i.failSuite(e,t,"suiteSetup",r.hookFn,r);i.runHooks(e.suiteTeardown,t,function(e){n(r)});return}i.runSuiteTests(e,t,function(r){i.runHooks(e.suiteTeardown,t,function(e){if(r){n(r)}else if(e){i.patchError(e);i.errors.push({name:e.hookFn.hookName+"["+e.hookFn.hookType+"]",type:e.hookFn.hookType,fn:e.hookFn,error:e});n(e)}else{n()}})})})};s.prototype.runSuiteTests=function h(e,t,r){var n=this;i.foreach(e,function(r,i){if(Array.isArray(r)){n.runSuite(r,t+1,i);return}n.runTest(e,t,r,i)}).fatal(n.bail).exec(r)};s.prototype.failSuite=function b(e,t,r,i,n){var s,a;for(s=0,a=e.length;s<a;s++){if(Array.isArray(e[s])){this.failSuite(e[s],t+1,r,i,n)}this.done++;this.fail++;this.emit("fail",e[s].testName,t,undefined,undefined,n)}};s.prototype.runTest=function g(e,t,r,i){var n=this;n.testInProgress=r;if(typeof r!=="function"){n.done++;n.skip++;n.emit("skip",r.testName,t);i();return}var a=e,o=e.setup,l=e.teardown;while(a.parent){a=a.parent;o=a.setup.concat(o);l=a.teardown.concat(l)}var u=r.length?s.asyncTest.bind(n):s.syncTest.bind(n);var c=function(e,s,a,o){if(e){n.done++;n.fail++;n.patchError(e);n.errors.push({name:(e.hookFn?e.hookFn.hookName+"["+e.hookFn.hookType+"] ":"")+r.testName,type:o,fn:r,error:e});n.emit("fail",r.testName,t,s,a,e);i(e)}else{n.done++;n.ok++;n.emit("ok",r.testName,t,s,a);i()}};n.runHooks(o,t,function(e){if(e){n.runHooks(l,t,function(t){c(e,undefined,undefined,"setup")});return}n.emit("enterTest",r.testName,t);u(r,function(e,i,s){n.emit("exitTest",r.testName,t);n.runHooks(l,t,function(t,n){if(e){c(e,i,s,"test",r)}else if(t){c(t,i,s,"teardown",n[n.length-1][2])}else{c(undefined,i,s)}})})})};s.syncTest=function d(e,t){var r,i,n=this.slowTime;t=this.freshCallback(t);var s={timeout:function(){},slow:function(e){n=e}};try{r=Date.now();e.call(s);i=Date.now()-r}catch(a){i=Date.now()-r;t(a,i,Math.floor(i/n));return}t(undefined,i,Math.floor(i/n))};s.asyncTest=function v(e,t){var r=this,i,n,s=false,a=null,o=r.slowTime;t=this.freshCallback(t);var l={timeout:function(e){if(s){return}if(a!==null){clearTimeout(a);a=null}a=setTimeout(u.bind(undefined,new Error("Test timeout (local)")),e)},slow:function(e){o=e}};var u=function f(e){if(s){return}n=Date.now()-i;s=true;if(a!==null){clearTimeout(a);a=null}r.offUncaughtException(f);t(e,n,Math.floor(n/o))};r.onceUncaughtException(u);a=setTimeout(u.bind(undefined,new Error("Test timeout")),r.timeout);try{i=Date.now();e.call(l,u)}catch(c){u(c)}};s.prototype.runHooks=function y(e,t,r){var n=this;i.foreach(e,function(e,r){var i=e.length?s.asyncHook.bind(n):s.syncHook.bind(n);n.emit("enterHook",e.hookType,e.hookName,t);i(e,function(i){n.emit("exitHook",e.hookType,e.hookName,t);if(i){i.hookFn=e}r(i)})}).fatal(true).exec(r)};s.syncHook=function m(e,t){t=this.freshCallback(t);try{e()}catch(r){t(r);return}t()};s.asyncHook=function x(e,t){var r=this,i=false;t=this.freshCallback(t);var n=function a(e){if(i){return}i=true;r.offUncaughtException(a);t(e)};this.onceUncaughtException(n);try{e(n)}catch(s){n(s)}};s.registerSuite=function w(e,t){if(!e||typeof e!=="string"||typeof t!=="function"){throw new Error("Usage is suite( name , fn )")}var r=this.registerStack[this.registerStack.length-1];var i=s.createSuite(e);this.registerStack.push(i);t();this.registerStack.pop();if(!i.length){return}Object.defineProperties(i,{order:{value:r.length}});s.sortSuite(i);r.push(i);Object.defineProperty(i,"parent",{value:r})};s.registerTest=function _(e,t){var r,i,n,s,a,o;if(!e||typeof e!=="string"){throw new Error("Usage is test( name , [fn] )")}o=this.registerStack[this.registerStack.length-1];for(r=0,i=this.grep.length;r<i;r++){a=false;if(e.match(this.grep[r])){continue}for(n=1,s=this.registerStack.length;n<s;n++){if(this.registerStack[n].name.match(this.grep[r])){a=true;break}}if(!a){return}}this.testCount++;if(typeof t!=="function"){t={}}Object.defineProperties(t,{testName:{value:e},order:{value:o.length}});o.push(t)};s.registerSkipTest=function k(e){return s.registerTest.call(this,e)};s.registerHook=function A(e,t,r){var i;if(typeof t==="function"){r=t;t=undefined}else if(typeof r!=="function"){throw new Error("Usage is hook( [name] , fn )")}Object.defineProperties(r,{hookName:{value:t||r.name||"[no name]"},hookType:{value:e}});i=this.registerStack[this.registerStack.length-1];i[e].push(r)};s.prototype.freshCallback=function T(e){var t=this;return function(){var r=arguments;t.microTimeout(function(){e.apply(t,r)})}};s.prototype.patchError=function j(e){var t,r,i;if(!e.stack){return}i=e.stack;if(!Array.isArray(i)){i=e.stack.split("\n")}for(t=0,r=i.length;t<r;t++){if(i[t].match(/(^|\/)tea-time\.js/)){i=i.slice(0,t);break}}e.stack=i.join("\n")}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"async-kit":3,"nextgen-events":9}],3:[function(e,t,r){"use strict";var i=e("./core.js");t.exports=i;i.wrapper=e("./wrapper.js");i.exit=e("./exit.js")},{"./core.js":4,"./exit.js":5,"./wrapper.js":6}],4:[function(e,t,r){"use strict";var i=e("events");var n=e("tree-kit/lib/extend.js");var s={};t.exports=s;s.EventEmitter=function b(e){this.asyncNice=parseInt(e);this.recursion=0};s.EventEmitter.prototype=Object.create(i.EventEmitter.prototype);s.EventEmitter.prototype.syncEmit=s.EventEmitter.prototype.emit;s.EventEmitter.prototype.constructor=s.EventEmitter;s.EventEmitter.prototype.asyncEmit=function g(){var e=this,t,r;if(typeof arguments[0]==="number"){t=arguments[0];r=Array.prototype.slice.call(arguments,1)}else{t=this.asyncNice;r=arguments}if(t===undefined){t=-1}this.recursion=1+(this.recursion||0);try{if(t<0){if(this.recursion>(-1-t)*10){setImmediate(function(){e.syncEmit.apply(e,r)})}else{e.syncEmit.apply(e,r)}}else{setTimeout(function(){e.syncEmit.apply(e,r)},e.asyncNice*10)}}catch(i){this.recursion--;throw i}this.recursion--;return this};s.EventEmitter.prototype.nice=function d(e){this.asyncNice=Math.floor(+e||0);return this};s.EventEmitter.prototype.defaultEmitIsAsync=function v(e){if(e===undefined||e){s.EventEmitter.prototype.emit=s.EventEmitter.prototype.asyncEmit}else{s.EventEmitter.prototype.emit=s.EventEmitter.prototype.syncEmit}return this};s.AsyncError=function y(e){Error.call(this);Error.captureStackTrace(this,this.constructor);this.message=e};s.AsyncError.prototype=Object.create(Error.prototype);s.AsyncError.prototype.constructor=s.AsyncError;s.Plan=function m(){throw new Error("[async] Cannot create an async Plan object directly")};s.Plan.prototype.constructor=s.Plan;var a={parallelLimit:{value:1,writable:true,enumerable:true,configurable:true},raceMode:{value:false,writable:true,enumerable:true,configurable:true},waterfallMode:{value:false,writable:true,enumerable:true,configurable:true},waterfallTransmitError:{value:false,writable:true,enumerable:true,configurable:true},whileAction:{value:undefined,writable:true,enumerable:true,configurable:true},whileActionBefore:{value:false,writable:true,enumerable:true,configurable:true},errorsAreFatal:{value:true,writable:true,enumerable:true,configurable:true},returnMapping1to1:{value:false,writable:true,enumerable:true,configurable:true},jobsData:{value:{},writable:true,enumerable:true},jobsKeys:{value:[],writable:true,enumerable:true},jobsUsing:{value:undefined,writable:true,enumerable:true},jobsTimeout:{value:undefined,writable:true,enumerable:true},returnLastJobOnly:{value:false,writable:true,enumerable:true},defaultAggregate:{value:undefined,writable:true,enumerable:true},returnAggregate:{value:false,writable:true,enumerable:true},transmitAggregate:{value:false,writable:true,enumerable:true},usingIsIterator:{value:false,writable:true,enumerable:true},thenAction:{value:undefined,writable:true,enumerable:true},catchAction:{value:undefined,writable:true,enumerable:true},finallyAction:{value:undefined,writable:true,enumerable:true},asyncEventNice:{value:-20,writable:true,enumerable:true},maxRetry:{value:0,writable:true,enumerable:true},retryTimeout:{value:0,writable:true,enumerable:true},retryMultiply:{value:1,writable:true,enumerable:true},retryMaxTimeout:{value:Infinity,writable:true,enumerable:true},execMappingMinInputs:{value:0,writable:true,enumerable:true},execMappingMaxInputs:{value:100,writable:true,enumerable:true},execMappingCallbacks:{value:["finally"],writable:true,enumerable:true},execMappingAggregateArg:{value:false,writable:true,enumerable:true},execMappingMinArgs:{value:0,writable:true,enumerable:true},execMappingMaxArgs:{value:101,writable:true,enumerable:true},execMappingSignature:{value:"( [finallyCallback] )",writable:true,enumerable:true},locked:{value:false,writable:true,enumerable:true}};s.do=function x(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.do(e);return t};s.parallel=function w(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{parallelLimit:{value:Infinity,writable:true,enumerable:true},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.do(e);return t};s.series=function _(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{parallelLimit:{value:1,enumerable:true},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.do(e);return t};s.race=function k(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{raceMode:{value:true,enumerable:true},parallelLimit:{value:Infinity,writable:true,enumerable:true},errorsAreFatal:{value:false,writable:true,enumerable:true},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.returnLastJobOnly=true;t.do(e);return t};s.waterfall=function A(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{waterfallMode:{value:true,enumerable:true},waterfallTransmitError:{value:false,writable:true,enumerable:true},parallelLimit:{value:1,enumerable:true},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.returnLastJobOnly=true;t.do(e);return t};s.foreach=s.forEach=function T(e,t){var r=Object.create(s.Plan.prototype,a);Object.defineProperties(r,{usingIsIterator:{value:true,writable:true,enumerable:true},errorsAreFatal:{value:false,writable:true,enumerable:true},execInit:{value:o.bind(r)},execNext:{value:l.bind(r)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(r)}});r.do(e);r.iterator(t);return r};s.map=function j(e,t){var r=Object.create(s.Plan.prototype,a);Object.defineProperties(r,{parallelLimit:{value:Infinity,writable:true,enumerable:true},usingIsIterator:{value:true,writable:true,enumerable:true},errorsAreFatal:{value:false,writable:true,enumerable:true},returnMapping1to1:{value:true,writable:false,enumerable:true},execInit:{value:o.bind(r)},execNext:{value:l.bind(r)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(r)}});r.do(e);r.iterator(t);return r};s.reduce=function C(e,t,r){var i=Object.create(s.Plan.prototype,a);Object.defineProperties(i,{parallelLimit:{value:1,writable:false,enumerable:true},usingIsIterator:{value:true,writable:true,enumerable:true},execInit:{value:o.bind(i)},execNext:{value:l.bind(i)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(i)}});if(arguments.length<3){r=t;t=undefined;i.execMappingMinInputs=0;i.execMappingMaxInputs=100;i.execMappingCallbacks=["finally"];i.execMappingAggregateArg=true;i.execMappingMinArgs=1;i.execMappingMaxArgs=102;i.execMappingSignature="( aggregateArg, [finallyCallback] )"}i.transmitAggregate=true;i.returnAggregate=true;i.defaultAggregate=t;i.do(e);i.iterator(r);return i};s.while=function E(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{waterfallMode:{value:false,enumerable:true},whileAction:{value:undefined,writable:true,enumerable:true},whileActionBefore:{value:true,writable:false,enumerable:true},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.while(e);return t};s.and=function M(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{elseAction:{value:undefined,writable:true,enumerable:true},castToBoolean:{value:false,writable:true,enumerable:true},useLogicAnd:{value:true},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:p},execLoopCallback:{value:c},execFinal:{value:h.bind(t)}});t.do(e);return t};s.or=function L(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{elseAction:{value:undefined,writable:true,enumerable:true},castToBoolean:{value:false,writable:true,enumerable:true},useLogicAnd:{value:false},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:p},execLoopCallback:{value:c},execFinal:{value:h.bind(t)}});t.do(e);return t};s.if=function I(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{elseAction:{value:true,writable:true,enumerable:true},castToBoolean:{value:true,writable:true,enumerable:true},useLogicAnd:{value:true},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:p},execLoopCallback:{value:c},execFinal:{value:h.bind(t)}});if(e){t.do(e)}return t};s.if.and=s.if;s.if.or=function O(e){var t=Object.create(s.Plan.prototype,a);Object.defineProperties(t,{elseAction:{value:true,writable:true,enumerable:true},castToBoolean:{value:true,writable:true,enumerable:true},useLogicAnd:{value:false},execInit:{value:o.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:p},execLoopCallback:{value:c},execFinal:{value:h.bind(t)}});if(e){t.do(e)}return t};s.callTimeout=function P(e,t,r,i){if(typeof r!=="function"){throw new Error("[async] async.callTimeout(): argument #0 should be a function")}var n=Object.create(s.Plan.prototype,a);Object.defineProperties(n,{returnLastJobOnly:{value:true,enumerable:true},jobsTimeout:{value:e,writable:true,enumerable:true},execInit:{value:o.bind(n)},execNext:{value:l.bind(n)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(n)}});var p=[r.bind(i)].concat(Array.prototype.slice.call(arguments,4));n.do([p]);return n.exec(t)};s.Plan.prototype.do=function S(e){if(this.locked){return this}if(e&&typeof e==="object"){this.jobsData=e}else if(typeof e==="function"){this.jobsData=[e];this.returnLastJobOnly=true}else{this.jobsData={}}this.jobsKeys=Object.keys(this.jobsData);return this};s.Plan.prototype.parallel=function N(e){if(this.locked){return this}if(e===undefined||e===true){this.parallelLimit=Infinity}else if(e===false){this.parallelLimit=1}else if(typeof e==="number"){this.parallelLimit=e}return this};s.Plan.prototype.race=function F(e){if(!this.locked){this.raceMode=e||e===undefined?true:false}return this};s.Plan.prototype.waterfall=function D(e){if(!this.locked){this.waterfallMode=e||e===undefined?true:false}return this};s.Plan.prototype.while=function U(e,t){if(this.locked){return this}this.whileAction=e;if(t!==undefined){this.whileActionBefore=t?true:false}return this};s.Plan.prototype.repeat=function K(e){if(this.locked){return this}var t=0;if(typeof e!=="number"){e=parseInt(e)}this.whileActionBefore=true;this.whileAction=function(r,i,n){t++;n(t<=e)};return this};s.Plan.prototype.fatal=function J(e){if(!this.locked){this.errorsAreFatal=e||e===undefined?true:false}return this};s.Plan.prototype.boolean=function R(e){if(!this.locked){this.castToBoolean=e||e===undefined?true:false}return this};s.Plan.prototype.transmitError=function H(e){if(!this.locked){this.waterfallTransmitError=e||e===undefined?true:false}return this};s.Plan.prototype.timeout=function B(e){if(!this.locked){if(typeof e==="number"){this.jobsTimeout=e}else{this.jobsTimeout=undefined}}return this};s.Plan.prototype.retry=function q(e,t,r,i){if(this.locked){return this}if(typeof e==="number"){this.maxRetry=e}if(typeof t==="number"){this.retryTimeout=t}if(typeof r==="number"){this.retryMultiply=r}if(typeof i==="number"){this.retryMaxTimeout=i}return this};s.Plan.prototype.lastJobOnly=function X(e){if(!this.locked){this.returnLastJobOnly=e||e===undefined?true:false}return this};s.Plan.prototype.mapping1to1=function W(e){if(!this.locked){this.returnMapping1to1=e||e===undefined?true:false}return this};s.Plan.prototype.using=function Q(e){if(!this.locked){this.jobsUsing=e}return this};s.Plan.prototype.iterator=function V(e){if(this.locked){return this}this.jobsUsing=e;this.usingIsIterator=true;return this};s.Plan.prototype.aggregator=function Y(e,t,r){if(!this.locked){return this}this.transmitAggregate=e||e===undefined?true:false;this.returnAggregate=t||t===undefined?true:false;if(arguments.length>2){this.defaultAggregate=r}return this};s.Plan.prototype.usingIterator=function z(e){if(!this.locked){this.usingIsIterator=e||e===undefined?true:false}return this};s.Plan.prototype.nice=function G(e){if(this.locked){return this}if(e===undefined||e===null||e===true){this.asyncEventNice=-1}else if(e===false){this.asyncEventNice=-20}else{this.asyncEventNice=e}return this};s.Plan.prototype.then=function Z(e){if(!this.locked){this.thenAction=e}return this};s.Plan.prototype.else=function $(e){if(!this.locked){this.elseAction=e||true}return this};s.Plan.prototype.catch=function ee(e){if(!this.locked){this.catchAction=e||true}return this};s.Plan.prototype.finally=function te(e){if(!this.locked){this.finallyAction=e||true}return this};s.Plan.prototype.clone=function re(){var e=Object.create(s.Plan.prototype,a);n(null,e,this);e.locked=false;return e};s.Plan.prototype.export=function ie(e){switch(e){case"execFinally":return this.clone().execFinally.bind(this);case"execThenCatch":return this.clone().execThenCatch.bind(this);case"execThenElse":return this.clone().execThenElse.bind(this);case"execThenElseCatch":return this.clone().execThenElseCatch.bind(this);case"execArgs":return this.clone().execArgs.bind(this);case"execKV":return this.clone().execKV.bind(this);default:return this.clone().exec.bind(this)}};s.Plan.prototype.exec=function ne(){var e={inputs:[],callbacks:{}},t=0,r;if(arguments.length<this.execMappingMinArgs){throw new Error("[async] Too few arguments, in this instance, the function signature is: fn"+this.execMappingSignature)}else if(arguments.length>this.execMappingMaxArgs){throw new Error("[async] Too much arguments, in this instance, the function signature is: fn"+this.execMappingSignature)}if(this.execMappingAggregateArg){t++;e.aggregate=arguments[0]}if(this.execMappingMinInputs===this.execMappingMaxInputs){e.inputs=Array.prototype.slice.call(arguments,t,this.execMappingMaxInputs+t);for(r=0;r<this.execMappingCallbacks.length&&e.inputs.length+r<arguments.length;r++){e.callbacks[this.execMappingCallbacks[r]]=arguments[e.inputs.length+t+r]}}else{e.inputs=Array.prototype.slice.call(arguments,t,-this.execMappingCallbacks.length);for(r=0;r<this.execMappingCallbacks.length;r++){e.callbacks[this.execMappingCallbacks[r]]=arguments[e.inputs.length+t+r]}}return this.execInit(e)};s.Plan.prototype.execFinally=function se(e){return this.execInit({inputs:[],callbacks:{"finally":e}})};s.Plan.prototype.execThenCatch=function ae(e,t,r){return this.execInit({inputs:[],callbacks:{then:e,"catch":t,"finally":r}})};s.Plan.prototype.execThenElse=function oe(e,t,r){return this.execInit({inputs:[],callbacks:{then:e,"else":t,"finally":r}})};s.Plan.prototype.execThenElseCatch=function le(e,t,r,i){return this.execInit({inputs:[],callbacks:{then:e,"else":t,"catch":r,"finally":i}})};s.Plan.prototype.execArgs=function ue(){return this.execInit({inputs:arguments,callbacks:{}})};s.Plan.prototype.execMapping=function ce(e){if(this.locked){return this}e=n(null,{minInputs:0,maxInputs:0},e);var t,r,i=5;e.minInputs=parseInt(e.minInputs);e.maxInputs=parseInt(e.maxInputs);if(e.minInputs<e.maxInputs){this.execMappingMinInputs=e.minInputs;this.execMappingMaxInputs=e.maxInputs}else{this.execMappingMinInputs=e.maxInputs;this.execMappingMaxInputs=e.minInputs}this.execMappingCallbacks=Array.isArray(e.callbacks)?e.callbacks:[];this.execMappingInputsName=Array.isArray(e.inputsName)?e.inputsName:[];this.execMappingSignature="( ";if(this.execMappingMinInputs===this.execMappingMaxInputs){this.execMappingMinArgs=this.execMappingMinInputs;this.execMappingMaxArgs=this.execMappingMaxInputs+this.execMappingCallbacks.length;if(e.aggregateArg){this.execMappingAggregateArg=e.aggregateArg;this.execMappingMinArgs++;this.execMappingMaxArgs++;this.execMappingSignature+="aggregateValue"}for(t=0;t<this.execMappingMaxInputs;t++){if(t>0||e.aggregateArg){this.execMappingSignature+=", "}if(t>=i&&typeof this.execMappingInputsName[t]!=="string"){this.execMappingSignature+="... ";break}this.execMappingSignature+=typeof this.execMappingInputsName[t]==="string"?this.execMappingInputsName[t]:"arg#"+(t+1)}for(r=0;r<this.execMappingCallbacks.length;r++){if(t+r>0||e.aggregateArg){this.execMappingSignature+=", "}this.execMappingSignature+="["+this.execMappingCallbacks[r]+"Callback]"}}else{this.execMappingMinArgs=this.execMappingMinInputs+this.execMappingCallbacks.length;this.execMappingMaxArgs=this.execMappingMaxInputs+this.execMappingCallbacks.length;if(e.aggregateArg){this.execMappingAggregateArg=e.aggregateArg;this.execMappingMinArgs++;this.execMappingMaxArgs++;this.execMappingSignature+="aggregateValue"}for(t=0;t<this.execMappingMaxInputs;t++){if(t>0||e.aggregateArg){this.execMappingSignature+=", "}if(t<this.execMappingMinInputs){if(t>=i&&typeof this.execMappingInputsName[t]!=="string"){this.execMappingSignature+="... ";break}this.execMappingSignature+=typeof this.execMappingInputsName[t]==="string"?this.execMappingInputsName[t]:"arg#"+(t+1)}else{if(t>=i&&typeof this.execMappingInputsName[t]!=="string"){this.execMappingSignature+="[...] ";break}this.execMappingSignature+="["+(typeof this.execMappingInputsName[t]==="string"?this.execMappingInputsName[t]:"arg#"+(t+1))+"]"}}for(r=0;r<this.execMappingCallbacks.length;r++){if(t+r>0||e.aggregateArg){this.execMappingSignature+=", "}this.execMappingSignature+=this.execMappingCallbacks[r]+"Callback"}}this.execMappingSignature+=" )";return this};s.Plan.prototype.execKV=function fe(e){if(e.inputs===undefined){e.inputs=[]}else if(!Array.isArray(e.inputs)){e.inputs=[e.inputs]}if(e.callbacks===undefined||typeof e.callbacks!=="object"){e.callbacks={}}if(e.then){e.callbacks.then=e.then}if(e.else){e.callbacks.else=e.else}if(e.catch){e.callbacks.catch=e.catch}if(e.finally){e.callbacks.finally=e.finally}return this.execInit(e)};s.Plan.prototype.execLoop=function pe(e){return this.execInit({},e)};s.Plan.prototype.execJob=function he(e,t,r,i){var a=this,o,l=e.jobsKeys[r];var u=Object.create(s.JobContext.prototype,{execContext:{value:e,enumerable:true},indexOfKey:{value:r,enumerable:true},tryIndex:{value:i,enumerable:true},aborted:{value:false,writable:true,enumerable:true},abortedLoop:{value:false,writable:true,enumerable:true}});Object.defineProperty(u,"callback",{value:this.execCallback.bind(this,u),enumerable:true});Object.defineProperty(u.callback,"jobContext",{value:u,enumerable:true});e.jobsStatus[l].status="pending";e.jobsStatus[l].tried++;if(typeof this.jobsUsing==="function"){if(this.usingIsIterator){if(this.transmitAggregate){if(this.jobsUsing.length<=3){this.jobsUsing.call(u,e.aggregate,t,u.callback)}else if(this.jobsUsing.length<=4){this.jobsUsing.call(u,e.aggregate,t,Array.isArray(e.jobsData)?r:l,u.callback)}else{this.jobsUsing.call(u,e.aggregate,t,Array.isArray(e.jobsData)?r:l,e.jobsData,u.callback)}}else{if(this.jobsUsing.length<=2){this.jobsUsing.call(u,t,u.callback)}else if(this.jobsUsing.length<=3){this.jobsUsing.call(u,t,Array.isArray(e.jobsData)?r:l,u.callback)}else{this.jobsUsing.call(u,t,Array.isArray(e.jobsData)?r:l,e.jobsData,u.callback)}}}else if(Array.isArray(t)){o=t.slice();if(this.transmitAggregate){o.unshift(e.aggregate)}o.push(u.callback);this.jobsUsing.apply(u,o)}else{this.jobsUsing.call(u,t,u.callback)}}else if(typeof t==="function"){if(this.waterfallMode&&r>0){o=e.results[e.jobsKeys[r-1]].slice(this.waterfallTransmitError?0:1);o.push(u.callback);t.apply(u,o)}else if(Array.isArray(this.jobsUsing)||this.execMappingMaxInputs){if(Array.isArray(this.jobsUsing)){o=n(null,[],this.jobsUsing,e.execInputs)}else{o=n(null,[],e.execInputs)}o.push(u.callback);t.apply(u,o)}else{t.call(u,u.callback)}}else if(Array.isArray(t)&&typeof t[0]==="function"){o=t.slice(1);o.push(u.callback);t[0].apply(u,o)}else if(typeof t==="object"&&t instanceof s.Plan){t.exec(u.callback)}else{this.execCallback.call(this,u);return this}if(e.jobsTimeoutTimers[l]!==undefined){clearTimeout(e.jobsTimeoutTimers[l]);e.jobsTimeoutTimers[l]=undefined}if(e.retriesTimers[l]!==undefined){clearTimeout(e.retriesTimers[l]);e.retriesTimers[l]=undefined}if(typeof this.jobsTimeout==="number"&&this.jobsTimeout!==Infinity){e.jobsTimeoutTimers[l]=setTimeout(function(){e.jobsTimeoutTimers[l]=undefined;e.jobsStatus[l].status="timeout";u.syncEmit("timeout");a.execCallback.call(a,u,new s.AsyncError("jobTimeout"))},this.jobsTimeout)}return this};s.Plan.prototype.execAction=function be(e,t,r){if(typeof t==="function"){t.apply(e,r)}else if(typeof t==="object"&&t instanceof s.Plan){t.exec()}};s.JobContext=function ge(){throw new Error("[async] Cannot create an async JobContext object directly")};s.JobContext.prototype=Object.create(s.EventEmitter.prototype);s.JobContext.prototype.constructor=s.JobContext;s.JobContext.prototype.abort=function de(){this.aborted=true;this.callback.apply(undefined,arguments)};s.JobContext.prototype.abortLoop=function ve(){this.aborted=true;this.abortedLoop=true;this.callback.apply(undefined,arguments)};s.ExecContext=function ye(){throw new Error("[async] Cannot create an async ExecContext object directly")};s.ExecContext.prototype=Object.create(s.EventEmitter.prototype);s.ExecContext.prototype.constructor=s.ExecContext;s.ExecContext.prototype.getJobsStatus=function me(){var e,t,r=Array.isArray(this.jobsData)?[]:{};for(e=0;e<this.jobsKeys.length;e++){t=this.jobsKeys[e];r[t]=n(null,{job:this.jobsData[t],result:this.results[t]},this.jobsStatus[t])}return r};function o(e,t){var r,i=Array.isArray(this.jobsData);var a=Object.create(s.ExecContext.prototype,{plan:{value:this},aggregate:{value:"aggregate"in e?e.aggregate:this.defaultAggregate,writable:true,enumerable:true},results:{value:i?[]:{},writable:true,enumerable:true},result:{value:undefined,writable:true,enumerable:true},jobsTimeoutTimers:{value:i?[]:{},writable:true},jobsStatus:{value:i?[]:{},writable:true,enumerable:true},retriesTimers:{value:i?[]:{},writable:true},retriesCounter:{value:i?[]:{},writable:true,enumerable:true},tryUserResponseCounter:{value:i?[]:{},writable:true,enumerable:true},tryResponseCounter:{value:i?[]:{},writable:true,enumerable:true},iterator:{value:0,writable:true,enumerable:true},pending:{value:0,writable:true,enumerable:true},resolved:{value:0,writable:true,enumerable:true},ok:{value:0,writable:true,enumerable:true},failed:{value:0,writable:true,enumerable:true},status:{value:undefined,writable:true,enumerable:true},error:{value:undefined,writable:true,enumerable:true},statusTriggerJobsKey:{value:undefined,writable:true,enumerable:true},whileStatus:{value:undefined,writable:true},whileChecked:{value:false,writable:true}});if(!t){Object.defineProperties(a,{root:{value:a,enumerable:true},jobsData:{value:i?this.jobsData.slice(0):n(null,{},this.jobsData),enumerable:true},jobsKeys:{value:this.jobsKeys.slice(0),enumerable:true},execInputs:{value:e.inputs,enumerable:true},execCallbacks:{value:e.callbacks},whileIterator:{value:0,enumerable:true,writable:true}})}else{Object.defineProperties(a,{root:{value:t.root,enumerable:true},jobsData:{value:t.jobsData,enumerable:true},jobsKeys:{value:t.jobsKeys,enumerable:true},execInputs:{
value:t.execInputs,enumerable:true},execCallbacks:{value:t.execCallbacks},whileIterator:{value:t.whileIterator+1,enumerable:true,writable:true}})}Object.defineProperties(a,{waiting:{value:a.jobsKeys.length,writable:true,enumerable:true}});for(r=0;r<a.jobsKeys.length;r++){a.jobsStatus[a.jobsKeys[r]]={status:"waiting",errors:[],tried:0}}a.nice(this.asyncEventNice);if(t===undefined){a.root.on("resolved",this.execFinal.bind(this,a));if(typeof this.whileAction==="function"){a.root.on("while",this.whileAction.bind(this));a.root.on("nextLoop",this.execLoop.bind(this))}else{this.whileAction=undefined;a.whileStatus=false}a.root.on("next",this.execNext.bind(this));if(this.whileAction&&this.whileActionBefore){a.whileIterator=-1;a.root.asyncEmit("while",a.error,a.results,this.execLoopCallback.bind(this,a));return this}}if(a.jobsKeys.length<=0){a.root.asyncEmit("resolved",a.error,a.results);a.root.asyncEmit("progress",{resolved:a.resolved,ok:a.ok,failed:a.failed,pending:a.pending,waiting:a.waiting,loop:a.whileIterator},a.error,a.results);a.root.asyncEmit("finish",a.error,a.results);return a.root}a.root.asyncEmit("next",a);return a.root}function l(e){var t,r,i=e.jobsKeys.length,n,s;n=e.iterator;for(;e.iterator<i&&e.pending<this.parallelLimit;e.iterator++){e.pending++;e.waiting--;t=e.iterator;r=e.jobsKeys[t];e.retriesCounter[r]=0;e.tryResponseCounter[r]=[];e.tryResponseCounter[r][0]=0;e.tryUserResponseCounter[r]=[];e.tryUserResponseCounter[r][0]=0;e.results[r]=undefined;s=e.iterator}for(t=n;t<=s;t++){this.execJob(e,e.jobsData[e.jobsKeys[t]],t,0)}}function u(e,t){var r=e.execContext,i=e.aborted,n=e.abortedLoop,a=e.indexOfKey,o=e.tryIndex;var l=this,u,c,f=r.jobsKeys.length,p=r.jobsKeys[a];var h=false,b=false,g=false,d=false;r.tryResponseCounter[p][o]++;if(!(t instanceof s.AsyncError)){r.tryUserResponseCounter[p][o]++}if(r.jobsTimeoutTimers[p]!==undefined){clearTimeout(r.jobsTimeoutTimers[p]);r.jobsTimeoutTimers[p]=undefined}if(r.retriesTimers[p]!==undefined){clearTimeout(r.retriesTimers[p]);r.retriesTimers[p]=undefined}if(r.tryUserResponseCounter[p][o]>1){r.jobsStatus[p].errors.push(new Error("This job has called its completion callback "+r.tryUserResponseCounter[p][o]+" times"));return}if(!i&&r.results[p]!==undefined){return}if(!i&&t&&this.maxRetry>r.retriesCounter[p]&&r.tryResponseCounter[p][o]<=1){r.jobsStatus[p].errors.push(t);u=this.retryTimeout*Math.pow(this.retryMultiply,r.retriesCounter[p]);if(u>this.retryMaxTimeout){u=this.retryMaxTimeout}r.retriesCounter[p]++;c=r.retriesCounter[p];r.retriesTimers[p]=setTimeout(function(){r.retriesTimers[p]=undefined;r.tryResponseCounter[p][c]=0;r.tryUserResponseCounter[p][c]=0;l.execJob(r,r.jobsData[p],a,c)},u);return}if(!i&&t&&o<r.retriesCounter[p]){return}r.resolved++;r.pending--;r.aggregate=arguments[2];if(i){r.failed++;r.jobsStatus[p].status="aborted"}else if(t){r.failed++;r.jobsStatus[p].errors.push(t);if(t instanceof s.AsyncError&&t.message==="jobTimeout"){r.jobsStatus[p].status="timeout"}else{r.jobsStatus[p].status="failed"}}else{r.ok++;r.jobsStatus[p].status="ok"}if(this.returnMapping1to1){r.results[p]=arguments[2]}else{r.results[p]=Array.prototype.slice.call(arguments,1)}if(r.status===undefined){if(this.raceMode&&!t){r.status="ok";r.statusTriggerJobsKey=p;if(this.whileAction&&!n){d=true}else{b=true}}else if(!this.raceMode&&t&&this.errorsAreFatal){r.status="fail";r.error=t;r.statusTriggerJobsKey=p;if(this.whileAction&&!n){d=true}else{b=true}}else if(i){r.status="aborted";r.statusTriggerJobsKey=p;if(this.whileAction&&!n){d=true}else{b=true}}}if(r.resolved>=f){if(r.status===undefined){if(this.raceMode){r.status="fail"}else{r.status="ok"}r.statusTriggerJobsKey=p;if(this.whileAction){d=true}else{b=g=true}}else{if(!this.whileAction||r.whileChecked&&r.whileStatus!==true){g=true}}}else if(r.status===undefined){if(r.iterator<f){h=true}}else if(r.pending<=0){if(!this.whileAction||r.whileChecked&&r.whileStatus!==true){g=true}}if(b){r.root.asyncEmit("resolved",r.error,r.results)}if(h){r.root.asyncEmit("next",r)}if(d){r.root.asyncEmit("while",r.error,r.results,this.execLoopCallback.bind(this,r))}r.root.asyncEmit("progress",{resolved:r.resolved,ok:r.ok,failed:r.failed,pending:r.pending,waiting:r.waiting,loop:r.whileIterator},r.error,r.results);if(g){r.root.asyncEmit("finish",r.error,r.results)}}function c(e){var t,r;var i=false,n=false,s=false;if(arguments.length<=1){t=undefined;r=false}else if(arguments[1]instanceof Error){e.error=arguments[1];t=arguments[1];r=false}else if(arguments.length<=2){t=arguments[1];r=t?true:false}else{t=arguments[2];r=t?true:false}if(r){e.whileStatus=true;i=true}else{e.whileStatus=false;n=true;if(e.pending<=0){s=true}}if(n){e.root.asyncEmit("resolved",e.error,e.results)}if(i){e.root.asyncEmit("nextLoop",e)}if(s){e.root.asyncEmit("finish",e.error,e.results)}e.whileChecked=true}function f(e,t,r){var i;if(t){if(this.returnAggregate){i=[t,e.aggregate]}else if(this.returnLastJobOnly){i=r[e.statusTriggerJobsKey]}else{i=[t,r]}if(this.catchAction){this.execAction(e,this.catchAction,i)}if(t&&e.execCallbacks.catch){this.execAction(e,e.execCallbacks.catch,i)}}else{if(this.returnAggregate){i=[e.aggregate]}else if(this.returnLastJobOnly){i=r[e.statusTriggerJobsKey].slice(1)}else{i=[r]}if(this.thenAction){this.execAction(e,this.thenAction,i)}if(e.execCallbacks.then){this.execAction(e,e.execCallbacks.then,i)}}if(this.returnAggregate){i=[t,e.aggregate]}else if(this.returnLastJobOnly){i=r[e.statusTriggerJobsKey]}else{i=[t,r]}if(this.finallyAction){this.execAction(e,this.finallyAction,i)}if(e.execCallbacks.finally){this.execAction(e,e.execCallbacks.finally,i)}}function p(e){var t=e.execContext,r=e.indexOfKey,i=e.tryIndex;var n=this,a,o,l,u,c=t.jobsKeys.length,f=t.jobsKeys[r];var p=false,h=false,b=false;if(arguments.length<=1){t.result=undefined;a=false}else if(arguments[1]instanceof Error){t.error=u=arguments[1];t.result=arguments[1];a=false}else if(arguments.length<=2){t.result=arguments[1];a=t.result?true:false}else{t.result=arguments[2];a=t.result?true:false}t.tryResponseCounter[f][i]++;if(!(u instanceof s.AsyncError)){t.tryUserResponseCounter[f][i]++}if(t.jobsTimeoutTimers[f]!==undefined){clearTimeout(t.jobsTimeoutTimers[f]);t.jobsTimeoutTimers[f]=undefined}if(t.retriesTimers[f]!==undefined){clearTimeout(t.retriesTimers[f]);t.retriesTimers[f]=undefined}if(t.results[f]!==undefined){return}if(t.tryUserResponseCounter[f][i]>1){return}if(u&&this.maxRetry>t.retriesCounter[f]&&t.tryResponseCounter[f][i]<=1){o=this.retryTimeout*Math.pow(this.retryMultiply,t.retriesCounter[f]);if(o>this.retryMaxTimeout){o=this.retryMaxTimeout}t.retriesCounter[f]++;l=t.retriesCounter[f];t.retriesTimers[f]=setTimeout(function(){t.retriesTimers[f]=undefined;t.tryResponseCounter[f][l]=0;t.tryUserResponseCounter[f][l]=0;n.execJob(t,t.jobsData[f],r,l)},o);return}if(u&&i<t.retriesCounter[f]){return}t.resolved++;t.pending--;if(u){t.failed++;if(u instanceof s.AsyncError&&u.message==="jobTimeout"){t.jobsStatus[f].status="timeout"}else{t.jobsStatus[f].status="failed"}}else{t.ok++;t.jobsStatus[f].status="ok"}if(this.castToBoolean&&(!(t.result instanceof Error)||!this.catchAction)){t.result=a}t.results[f]=t.result;if(a!==this.useLogicAnd&&t.status===undefined){t.status=!this.useLogicAnd;h=true}if(t.resolved>=c){if(t.status===undefined){t.status=this.useLogicAnd;h=true}b=true}else if(t.status===undefined){if(t.iterator<c){p=true}}else if(t.pending<=0){b=true}if(h){t.root.asyncEmit("resolved",t.result)}if(p){t.root.asyncEmit("next",t)}t.root.asyncEmit("progress",{resolved:t.resolved,pending:t.pending,waiting:t.waiting,loop:t.whileIterator},t.result);if(b){t.root.asyncEmit("finish",t.result)}}function h(e,t){if(t instanceof Error){if(this.catchAction){this.execAction(e,this.catchAction,[t])}else if(this.elseAction){this.execAction(e,this.elseAction,[t])}}else if(!e.result&&this.elseAction){this.execAction(e,this.elseAction,[t])}else if(e.result&&this.thenAction){this.execAction(e,this.thenAction,[t])}if(this.finallyAction){this.execAction(e,this.finallyAction,[t])}if(t instanceof Error){if(e.execCallbacks.catch){this.execAction(e,e.execCallbacks.catch,[t])}else if(e.execCallbacks.else){this.execAction(e,e.execCallbacks.else,[t])}}else if(!e.result&&e.execCallbacks.else){this.execAction(e,e.execCallbacks.else,[t])}else if(e.result&&e.execCallbacks.then){this.execAction(e,e.execCallbacks.then,[t])}if(e.execCallbacks.finally){this.execAction(e,e.execCallbacks.finally,[t])}}},{events:7,"tree-kit/lib/extend.js":10}],5:[function(e,t,r){(function(r){"use strict";var i=e("./async.js");var n=false;function s(e,t){if(n){return}n=true;var s=r.listeners("asyncExit");if(!s.length){r.exit(e);return}if(t===undefined){t=1e3}i.parallel(s).using(function(r,i){if(r.length<3){r(e,t);i()}else{r(e,t,i)}}).fatal(false).timeout(t).exec(function(){r.exit(e)})}t.exports=s}).call(this,e("_process"))},{"./async.js":3,_process:8}],6:[function(e,t,r){"use strict";var i={};t.exports=i;i.timeout=function n(e,t,r){var i=function(){var i=r||this,n=false,s=Array.prototype.slice.call(arguments),a=s.pop();var o=function(){if(n){return}n=true;a.apply(i,arguments)};s.push(o);e.apply(i,s);setTimeout(o.bind(undefined,new Error("Timeout")),t)};return i}},{}],7:[function(e,t,r){function i(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=i;i.EventEmitter=i;i.prototype._events=undefined;i.prototype._maxListeners=undefined;i.defaultMaxListeners=10;i.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};i.prototype.emit=function(e){var t,r,i,s,l,u;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||a(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}throw TypeError('Uncaught, unspecified "error" event.')}}r=this._events[e];if(o(r))return false;if(n(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1);r.apply(this,s)}}else if(a(r)){s=Array.prototype.slice.call(arguments,1);u=r.slice();i=u.length;for(l=0;l<i;l++)u[l].apply(this,s)}return true};i.prototype.addListener=function(e,t){var r;if(!n(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,n(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(a(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(a(this._events[e])&&!this._events[e].warned){if(!o(this._maxListeners)){r=this._maxListeners}else{r=i.defaultMaxListeners}if(r&&r>0&&this._events[e].length>r){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};i.prototype.on=i.prototype.addListener;i.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=false;function i(){this.removeListener(e,i);if(!r){r=true;t.apply(this,arguments)}}i.listener=t;this.on(e,i);return this};i.prototype.removeListener=function(e,t){var r,i,s,o;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];s=r.length;i=-1;if(r===t||n(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(a(r)){for(o=s;o-- >0;){if(r[o]===t||r[o].listener&&r[o].listener===t){i=o;break}}if(i<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(i,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};i.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(n(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};i.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(n(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;else if(t)return t.length}return 0};i.listenerCount=function(e,t){return e.listenerCount(t)};function n(e){return typeof e==="function"}function s(e){return typeof e==="number"}function a(e){return typeof e==="object"&&e!==null}function o(e){return e===void 0}},{}],8:[function(e,t,r){var i=t.exports={};var n=[];var s=false;var a;var o=-1;function l(){if(!s||!a){return}s=false;if(a.length){n=a.concat(n)}else{o=-1}if(n.length){u()}}function u(){if(s){return}var e=setTimeout(l);s=true;var t=n.length;while(t){a=n;n=[];while(++o<t){if(a){a[o].run()}}o=-1;t=n.length}a=null;s=false;clearTimeout(e)}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}n.push(new c(e,t));if(n.length===1&&!s){setTimeout(u,0)}};function c(e,t){this.fun=e;this.array=t}c.prototype.run=function(){this.fun.apply(null,this.array)};i.title="browser";i.browser=true;i.env={};i.argv=[];i.version="";i.versions={};function f(){}i.on=f;i.addListener=f;i.once=f;i.off=f;i.removeListener=f;i.removeAllListeners=f;i.emit=f;i.binding=function(e){throw new Error("process.binding is not supported")};i.cwd=function(){return"/"};i.chdir=function(e){throw new Error("process.chdir is not supported")};i.umask=function(){return 0}},{}],9:[function(e,t,r){function i(){return Object.create(i.prototype)}t.exports=i;i.SYNC=-Infinity;i.init=function s(){Object.defineProperty(this,"__ngev",{value:{nice:i.SYNC,interruptible:false,recursion:0,contexts:{},events:{error:[],interrupt:[],newListener:[],removeListener:[]}}})};i.filterOutCallback=function(e,t){return e!==t};i.prototype.addListener=function a(e,t,r){var n={};if(!this.__ngev){i.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}if(!e||typeof e!=="string"){throw new TypeError(".addListener(): argument #0 should be a non-empty string")}if(typeof t!=="function"){r=t;t=undefined}if(!r||typeof r!=="object"){r={}}n.fn=t||r.fn;n.id=typeof r.id==="string"?r.id:n.fn;n.once=!!r.once;n.async=!!r.async;n.nice=r.nice!==undefined?Math.floor(r.nice):i.SYNC;n.context=typeof r.context==="string"?r.context:null;if(typeof n.fn!=="function"){throw new TypeError(".addListener(): a function or an object with a 'fn' property which value is a function should be provided")}if(n.context&&typeof n.context==="string"&&!this.__ngev.contexts[n.context]){this.addListenerContext(n.context)}n.event=e;if(this.__ngev.events.newListener.length){this.emit("newListener",[n])}this.__ngev.events[e].push(n);return this};i.prototype.on=i.prototype.addListener;i.prototype.once=function o(e,t){if(!e||typeof e!=="string"){throw new TypeError(".once(): argument #0 should be a non-empty string")}if(typeof t==="function"){t={id:t,fn:t}}else if(!t||typeof t!=="object"||typeof t.fn!=="function"){throw new TypeError(".once(): argument #1 should be a function or an object with a 'fn' property which value is a function")}t.once=true;return this.addListener(e,t)};i.prototype.removeListener=function l(e,t){var r,n,s=[],a=[];if(!e||typeof e!=="string"){throw new TypeError(".removeListener(): argument #0 should be a non-empty string")}if(!this.__ngev){i.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}n=this.__ngev.events[e].length;for(r=0;r<n;r++){if(this.__ngev.events[e][r].id===t){a.push(this.__ngev.events[e][r])}else{s.push(this.__ngev.events[e][r])}}this.__ngev.events[e]=s;if(a.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",a)}return this};i.prototype.off=i.prototype.removeListener;i.prototype.removeAllListeners=function u(e){var t;if(!this.__ngev){i.init.call(this)}if(e){if(!e||typeof e!=="string"){throw new TypeError(".removeAllListener(): argument #0 should be undefined or a non-empty string")}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}t=this.__ngev.events[e];this.__ngev.events[e]=[];if(t.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",t)}}else{this.__ngev.events={}}return this};i.listenerWrapper=function c(e,t,r){var n,s;if(t.interrupt){return}if(e.async){if(r){s=r.serial;r.ready=!s}n=e.fn.apply(undefined,t.args.concat(function(r){t.listenersDone++;if(r&&t.emitter.__ngev.interruptible&&!t.interrupt&&t.name!=="interrupt"){t.interrupt=r;if(t.callback){t.callback(t.interrupt,t);delete t.callback}t.emitter.emit("interrupt",t.interrupt)}else if(t.listenersDone>=t.listeners&&t.callback){t.callback(undefined,t);delete t.callback}if(s){i.processQueue.call(t.emitter,e.context,true)}}))}else{n=e.fn.apply(undefined,t.args);t.listenersDone++}if(n&&t.emitter.__ngev.interruptible&&!t.interrupt&&t.name!=="interrupt"){t.interrupt=n;if(t.callback){t.callback(t.interrupt,t);delete t.callback}t.emitter.emit("interrupt",t.interrupt)}else if(t.listenersDone>=t.listeners&&t.callback){t.callback(undefined,t);delete t.callback}};var n=0;i.prototype.emit=function f(){var e,t,r=0,s,a,o,l,u,c=[];s={emitter:this,id:n++,name:null,args:null,nice:null,interrupt:null,listeners:null,listenersDone:0,callback:null};if(!this.__ngev){i.init.call(this)}if(typeof arguments[0]==="number"){s.nice=Math.floor(arguments[0]);s.name=arguments[1];if(!s.name||typeof s.name!=="string"){throw new TypeError(".emit(): when argument #0 is a number, argument #1 should be a non-empty string")}if(typeof arguments[arguments.length-1]==="function"){s.callback=arguments[arguments.length-1];s.args=Array.prototype.slice.call(arguments,2,-1)}else{s.args=Array.prototype.slice.call(arguments,2)}}else{s.nice=this.__ngev.nice;s.name=arguments[0];if(!s.name||typeof s.name!=="string"){throw new TypeError(".emit(): argument #0 should be an number or a non-empty string")}s.args=Array.prototype.slice.call(arguments,1);if(typeof arguments[arguments.length-1]==="function"){s.callback=arguments[arguments.length-1];s.args=Array.prototype.slice.call(arguments,1,-1)}else{s.args=Array.prototype.slice.call(arguments,1)}}if(!this.__ngev.events[s.name]){this.__ngev.events[s.name]=[]}s.listeners=this.__ngev.events[s.name].length;this.__ngev.recursion++;u=this.__ngev.events[s.name].slice();for(e=0,t=u.length;e<t;e++){r++;a=u[e];o=a.context&&this.__ngev.contexts[a.context];if(o&&o.status===i.CONTEXT_DISABLED){continue}if(o){l=Math.max(s.nice,a.nice,o.nice)}else{l=Math.max(s.nice,a.nice)}if(a.once){this.__ngev.events[s.name]=this.__ngev.events[s.name].filter(i.filterOutCallback.bind(undefined,a));c.push(a)}if(o&&(o.status===i.CONTEXT_QUEUED||!o.ready)){o.queue.push({event:s,listener:a,nice:l})}else{try{if(l<0){if(this.__ngev.recursion>=-l){setImmediate(i.listenerWrapper.bind(this,a,s,o))}else{i.listenerWrapper.call(this,a,s,o)}}else{setTimeout(i.listenerWrapper.bind(this,a,s,o),l)}}catch(f){this.__ngev.recursion--;throw f}}}this.__ngev.recursion--;if(c.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",c)}if(!r){if(s.name==="error"){if(arguments[1]){throw arguments[1]}else{throw Error("Uncaught, unspecified 'error' event.")}}if(s.callback){s.callback(undefined,s);delete s.callback}}return s};i.prototype.listeners=function p(e){if(!e||typeof e!=="string"){throw new TypeError(".listeners(): argument #0 should be a non-empty string")}if(!this.__ngev){i.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}return this.__ngev.events[e].slice()};i.listenerCount=function(e,t){if(!e||!(e instanceof i)){throw new TypeError(".listenerCount(): argument #0 should be an instance of NextGenEvents")}return e.listenerCount(t)};i.prototype.listenerCount=function(e){if(!e||typeof e!=="string"){throw new TypeError(".listenerCount(): argument #1 should be a non-empty string")}if(!this.__ngev){i.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}return this.__ngev.events[e].length};i.prototype.setNice=function h(e){if(!this.__ngev){i.init.call(this)}this.__ngev.nice=Math.floor(+e||0)};i.prototype.setInterruptible=function b(e){if(!this.__ngev){i.init.call(this)}this.__ngev.interruptible=!!e};i.prototype.setMaxListeners=function(){};i.noop=function(){};i.CONTEXT_ENABLED=0;i.CONTEXT_DISABLED=1;i.CONTEXT_QUEUED=2;i.prototype.addListenerContext=function g(e,t){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".addListenerContext(): argument #0 should be a non-empty string")}if(!t||typeof t!=="object"){t={}}if(!this.__ngev.contexts[e]){this.__ngev.contexts[e]=Object.create(i.prototype);this.__ngev.contexts[e].nice=i.SYNC;this.__ngev.contexts[e].ready=true;this.__ngev.contexts[e].status=i.CONTEXT_ENABLED;this.__ngev.contexts[e].serial=false;this.__ngev.contexts[e].queue=[]}if(t.nice!==undefined){this.__ngev.contexts[e].nice=Math.floor(t.nice)}if(t.status!==undefined){this.__ngev.contexts[e].status=t.status}if(t.serial!==undefined){this.__ngev.contexts[e].serial=!!t.serial}return this};i.prototype.disableListenerContext=function d(e){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".disableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=i.CONTEXT_DISABLED;return this};i.prototype.enableListenerContext=function v(e){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".enableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=i.CONTEXT_ENABLED;if(this.__ngev.contexts[e].queue.length>0){i.processQueue.call(this,e)}return this};i.prototype.queueListenerContext=function y(e){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".queueListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=i.CONTEXT_QUEUED;return this};i.prototype.serializeListenerContext=function m(e,t){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".serializeListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].serial=t===undefined?true:!!t;return this};i.prototype.setListenerContextNice=function x(e,t){if(!this.__ngev){i.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".setListenerContextNice(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].nice=Math.floor(t);return this};i.prototype.destroyListenerContext=function w(e){var t,r,n,s,a=[];if(!e||typeof e!=="string"){throw new TypeError(".disableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev){i.init.call(this)}for(n in this.__ngev.events){s=null;r=this.__ngev.events[n].length;for(t=0;t<r;t++){if(this.__ngev.events[n][t].context===e){s=[];a.push(this.__ngev.events[n][t])}else if(s){s.push(this.__ngev.events[n][t])}}if(s){this.__ngev.events[n]=s}}if(this.__ngev.contexts[e]){delete this.__ngev.contexts[e]}if(a.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",a)}return this};i.processQueue=function _(e,t){var r,n;if(!this.__ngev.contexts[e]){return}r=this.__ngev.contexts[e];if(t){r.ready=true}this.__ngev.recursion++;while(r.ready&&r.queue.length){n=r.queue.shift();if(n.event.interrupt){continue}try{if(n.nice<0){if(this.__ngev.recursion>=-n.nice){setImmediate(i.listenerWrapper.bind(this,n.listener,n.event,r))}else{i.listenerWrapper.call(this,n.listener,n.event,r)}}else{setTimeout(i.listenerWrapper.bind(this,n.listener,n.event,r),n.nice)}}catch(s){this.__ngev.recursion--;throw s}}this.__ngev.recursion--}},{}],10:[function(e,t,r){"use strict";function i(e,t,r){var n,s,a,o,l,u,c,f,p,h,b,g,d=-1,v=false,y=arguments.length;if(!t||typeof t!=="object"){t={}}if(!e){e={depth:0,prefix:""};if(!t.maxDepth&&t.deep&&!t.circular){t.maxDepth=100}if(t.deepFunc){t.deep=true}if(t.deepFilter&&typeof t.deepFilter==="object"){if(t.deepFilter.whitelist&&(!Array.isArray(t.deepFilter.whitelist)||!t.deepFilter.whitelist.length)){delete t.deepFilter.whitelist}if(t.deepFilter.blacklist&&(!Array.isArray(t.deepFilter.blacklist)||!t.deepFilter.blacklist.length)){delete t.deepFilter.blacklist}if(!t.deepFilter.whitelist&&!t.deepFilter.blacklist){delete t.deepFilter}}if(t.flat){t.deep=true;t.proto=false;t.inherit=false;t.unflat=false;if(typeof t.flat!=="string"){t.flat="."}}if(t.unflat){t.deep=false;t.proto=false;t.inherit=false;t.flat=false;if(typeof t.unflat!=="string"){t.unflat="."}}if(t.inherit){t.own=true;t.proto=false}else if(t.proto){t.own=true}if(!r||typeof r!=="object"&&typeof r!=="function"){v=true}if(!t.skipRoot&&(t.inherit||t.proto)){for(n=y-1;n>=3;n--){o=arguments[n];if(o&&(typeof o==="object"||typeof o==="function")){if(t.inherit){if(v){r=Object.create(o)}else{r.__proto__=o}}else if(t.proto){if(v){r=Object.create(o.__proto__)}else{r.__proto__=o.__proto__}}break}}}else if(v){r={}}e.references={sources:[],targets:[]}}if(t.maxDepth&&e.depth>t.maxDepth){throw new Error("[tree] extend(): max depth reached("+t.maxDepth+")")}for(n=3;n<y;n++){o=arguments[n];if(!o||typeof o!=="object"&&typeof o!=="function"){continue}if(t.circular){e.references.sources.push(o);e.references.targets.push(r)}if(t.own){if(t.nonEnum){l=Object.getOwnPropertyNames(o)}else{l=Object.keys(o)}}else{l=o}for(u in l){if(t.own){u=l[u]}if(t.descriptor){p=Object.getOwnPropertyDescriptor(o,u);c=p.value}else{c=o[u]}b=r;h=e.prefix+u;if(t.nofunc&&typeof c==="function"){continue}if(t.unflat&&e.depth===0){g=u.split(t.unflat);a=g.length-1;if(a){for(s=0;s<a;s++){if(!b[g[s]]||typeof b[g[s]]!=="object"&&typeof b[g[s]]!=="function"){b[g[s]]={}}b=b[g[s]]}h=e.prefix+g[a]}}if(t.deep&&c&&(typeof c==="object"||t.deepFunc&&typeof c==="function")&&(!t.descriptor||!p.get)&&(!t.deepFilter||(!t.deepFilter.whitelist||t.deepFilter.whitelist.indexOf(c.__proto__)!==-1)&&(!t.deepFilter.blacklist||t.deepFilter.blacklist.indexOf(c.__proto__)===-1))){if(t.circular){d=e.references.sources.indexOf(c)}if(t.flat){if(d>=0){continue}i({depth:e.depth+1,prefix:e.prefix+u+t.flat,references:e.references},t,b,c)}else{if(d>=0){if(t.descriptor){Object.defineProperty(b,h,{value:e.references.targets[d],enumerable:p.enumerable,writable:p.writable,configurable:p.configurable})}else{b[h]=e.references.targets[d]}continue}if(!b[h]||!b.hasOwnProperty(h)||typeof b[h]!=="object"&&typeof b[h]!=="function"){if(Array.isArray(c)){f=[]}else if(t.proto){f=Object.create(c.__proto__)}else if(t.inherit){f=Object.create(c)}else{f={}}if(t.descriptor){Object.defineProperty(b,h,{value:f,enumerable:p.enumerable,writable:p.writable,configurable:p.configurable})}else{b[h]=f}}else if(t.proto&&b[h].__proto__!==c.__proto__){b[h].__proto__=c.__proto__}else if(t.inherit&&b[h].__proto__!==c){b[h].__proto__=c}if(t.circular){e.references.sources.push(c);e.references.targets.push(b[h])}i({depth:e.depth+1,prefix:"",references:e.references},t,b[h],c)}}else if(t.preserve&&b[h]!==undefined){continue}else if(!t.inherit){if(t.descriptor){Object.defineProperty(b,h,p)}else{b[h]=c}}if(t.move){delete o[u]}}}return r}t.exports=i.bind(undefined,null)},{}]},{},[1])(1)});